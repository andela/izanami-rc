<template name="performanceAnalytics">
  <div class="container" style="margin-top:20px; margin-bottom: 20px">
    <label labelFor="fromdatepicker" style="margin-left: 40px">From: </label> <input type="text" id="fromdatepicker">
    <label labelFor="todatepicker" style="margin-left: 40px">To: </label> <input type="text" id="todatepicker">
  </div>
  <ul class="nav nav-tabs nav-justified">
    <li class="active"><a data-toggle="tab" href="#overview"><strong>Overview</strong></a></li>
    <li><a data-toggle="tab" href="#menu2"><strong>Top Sellers</strong></a></li>
    <li><a data-toggle="tab" href="#menu3"><strong>Top Earners</strong></a></li>
    <li><a data-toggle="tab" href="#menu4"><strong>Statements</strong></a></li>
    <li><a data-toggle="tab" href="#menu5"><strong>Orders</strong></a></li>
  </ul>

  <div class="tab-content">
    <div id="overview" class="tab-pane fade in active">
      {{> overview ordersCancelled=ordersCancelled ordersPlaced=ordersPlaced totalSales=totalSales totalItemsPurchased=totalItemsPurchased totalShippingCost=totalShippingCost salesPerDay=salesPerDay}}
      <div style="width:100%;height:100%;margin:auto">
        <div style="display:inline-block;position:relative;width:30%;height:30%">
          <canvas id="sales" width="100%" height="100%" style="display:inline-block;position:relative"></canvas>
        </div>
        <div style="display:inline-block;position:relative;width:30%;height:30%">
          <canvas id="orders" width="100%" height="100%" style="display:inline-block;position:relative"></canvas>
        </div>
      </div>
    </div>
    <div id="menu2" class="tab-pane fade">
      {{> topSeller bestSelling=bestSelling}}
      <div style="width:300px;height:300px;margin:auto">
        <canvas id="myPie" width="100%" height="100%"></canvas>
      </div>
    </div>
    <div id="menu3" class="tab-pane fade">
      {{> topEarner topEarning=topEarning }}
      <div style="width:300px;height:300px;margin:auto">
        <canvas id="myEarnerPie" width="100%" height="100%"></canvas>
      </div>
    </div>
    <div id="menu4" class="tab-pane fade">
      {{> statement statements=statements}}
    </div>
    <div id="menu5" class="tab-pane fade">
      {{> ordersAnalytics orders=orders }}
    </div>
  </div>
  <script>

    productArray = [];
    quantity = [];
    productEarnerArray = [];
    totalSalesArray = [];

    placed = document.getElementById('ordersPlaced').innerHTML;
    cancelled = document.getElementById('ordersCancelled').innerHTML;
    Tsales = document.getElementById("totalSales").innerHTML.slice(1).replace(/[,]/g, '');
    persales = document.getElementById("salesPerDay").innerHTML.slice(1).replace(/[,]/g, '');

    $('.productName').each(function(i,obj) {
      productArray.push(obj.innerHTML);
    });
    $('.qtySold').each(function(i,obj) {
      quantity.push(obj.innerHTML);
    });
    $('.productEarnerName').each(function(i,obj) {
      productEarnerArray.push(obj.innerHTML);
    });
    $('.totalSalesEarner').each(function(i,obj) {
      totalSalesArray.push(obj.innerHTML.slice(1).replace(/[,]/g, ''));
    });
    var ctxbar1 = document.getElementById("sales");
    var ctxbar2 = document.getElementById("orders");

    var ctxPie = document.getElementById("myPie");
    var ctxEarnerPie = document.getElementById("myEarnerPie");
    var myPie = new Chart(ctxPie, {
      type: "pie",
      data: {
        labels: productArray,
        datasets: [{
          data: quantity,
          backgroundColor: [
            "rgba(255, 99, 132, 0.2)",
            "rgba(54, 162, 235, 0.2)",
            "rgba(255, 206, 86, 0.2)",
            "rgba(75, 192, 192, 0.2)",
            "rgba(153, 102, 255, 0.2)",
            "rgba(255, 159, 64, 0.2)",
            'rgba(88, 44, 60, 0.9)',
            'rgba(6, 44, 60, 0.9)',
            'rgba(6, 26, 0, 0.9)',
            'rgba(6, 26, 142, 0.9)',
            'rgba(3, 139, 142, 0.9)',
            'rgba(3, 255, 255, 0.9)'
          ],
          borderColor: [
            "rgba(255,99,132,1)",
            "rgba(54, 162, 235, 1)",
            "rgba(255, 206, 86, 1)",
            "rgba(75, 192, 192, 1)",
            "rgba(153, 102, 255, 1)",
            "rgba(255, 159, 64, 1)",
            'rgba(88, 44, 60, 1)',
            'rgba(6, 44, 60, 1)',
            'rgba(6, 26, 0, 1)',
            'rgba(6, 26, 142, 1)',
            'rgba(3, 139, 142, 1)',
            'rgba(3, 255, 255, 1)'
          ],
          borderWidth: 1
        }]
      },
      options: {
        animation:{
            animateScale:true
          }
        }
    });
    var myEarnerPie = new Chart(ctxEarnerPie, {
      type: "pie",
      data: {
        labels: productEarnerArray,
        datasets: [{
          data: totalSalesArray,
          backgroundColor: [
            "rgba(255, 99, 132, 0.2)",
            "rgba(54, 162, 235, 0.2)",
            "rgba(255, 206, 86, 0.2)",
            "rgba(75, 192, 192, 0.2)",
            "rgba(153, 102, 255, 0.2)",
            "rgba(255, 159, 64, 0.2)",
            'rgba(88, 44, 60, 0.9)',
            'rgba(6, 44, 60, 0.9)',
            'rgba(6, 26, 0, 0.9)',
            'rgba(6, 26, 142, 0.9)',
            'rgba(3, 139, 142, 0.9)',
            'rgba(3, 255, 255, 0.9)'
          ],
          borderColor: [
            "rgba(255,99,132,1)",
            "rgba(54, 162, 235, 1)",
            "rgba(255, 206, 86, 1)",
            "rgba(75, 192, 192, 1)",
            "rgba(153, 102, 255, 1)",
            "rgba(255, 159, 64, 1)",
            'rgba(88, 44, 60, 1)',
            'rgba(6, 44, 60, 1)',
            'rgba(6, 26, 0, 1)',
            'rgba(6, 26, 142, 1)',
            'rgba(3, 139, 142, 1)',
            'rgba(3, 255, 255, 1)'
          ],
          borderWidth: 1
        }]
      },
      options: {
        animation:{
            animateScale:true
          }
        }
    });

    var sales = new Chart(ctxbar1, {
      type: 'bar',
      data: {
          labels: ["Total Sale", "Sales per day"],
          datasets: [{
              label: '# of Votes',
              data: [Tsales, persales],
              backgroundColor: [
                  'rgba(255, 99, 132, 0.2)',
                  'rgba(54, 162, 235, 0.2)',
                  'rgba(255, 206, 86, 0.2)',
                  'rgba(75, 192, 192, 0.2)',
                  'rgba(153, 102, 255, 0.2)',
                  'rgba(255, 159, 64, 0.2)'
              ],
              borderColor: [
                  'rgba(255,99,132,1)',
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(153, 102, 255, 1)',
                  'rgba(255, 159, 64, 1)'
              ],
              borderWidth: 1
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero:true
                  }
              }]
          }
      }
    });
    var orders = new Chart(ctxbar2, {
      type: 'bar',
      data: {
          labels: ["Orders placed", "Orders cancelled"],
          datasets: [{
              label: '# of Votes',
              data: [placed, cancelled],
              backgroundColor: [
                  'rgba(255, 99, 132, 0.2)',
                  'rgba(54, 162, 235, 0.2)',
                  'rgba(255, 206, 86, 0.2)',
                  'rgba(75, 192, 192, 0.2)',
                  'rgba(153, 102, 255, 0.2)',
                  'rgba(255, 159, 64, 0.2)'
              ],
              borderColor: [
                  'rgba(255,99,132,1)',
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(153, 102, 255, 1)',
                  'rgba(255, 159, 64, 1)'
              ],
              borderWidth: 1
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero:true
                  }
              }]
          }
      }
  });

  </script>
</template>

<template name="overview">
  <div class="card" style="margin:20px">
    <h2>Performance Analytics Overview</h2>
    <ul class="list-group list-group-flush">
      <li class="list-group-item">
        <h4>Total Sales: <strong id="totalSales">{{totalSales}}</strong></h4>
      </li>
      <li class="list-group-item">
        <h4>Average Daily Sales: <strong id="salesPerDay">{{salesPerDay}}</strong></h4>
      </li>
      <li class="list-group-item">
        <h4>Total Orders Placed: <strong id="ordersPlaced">{{ordersPlaced}}</strong></h4>
      </li>
      <li class="list-group-item">
        <h4>Total Orders Cancelled: <strong id="ordersCancelled">{{ordersCancelled}}</strong></h4>
      </li>
      <li class="list-group-item">
        <h4>Total Items Sold: <strong>{{totalItemsPurchased}}</strong></h4>
      </li>
      <li class="list-group-item">
        <h4>Total Shipping Charges: <strong>{{totalShippingCost}}</strong></h4>
      </li>
    </ul>
  </div>
</template>

<template name="topSeller">
  <div class="card" style="margin:20px">
    <h2>Know what products are getting the highest sales</h2>
    <table class="table table-striped table-hover table-responsive table-bordered">
      {{#if bestSelling}}
      <thead>
        <tr>
          <th>Product</th>
          <th>Quantity Sold</th>
        </tr>
      </thead>
      <tbody>
        {{#each bestSelling}}
        <tr>
          <td class="productName">{{product}}</td>
          <td class="qtySold">{{quantitySold}}</td>
        </tr>
        {{/each}}
      </tbody>
      {{ else }}
      <thead>
        <tr>
          <th>No Data to display</th>
        </tr>
      </thead>
      {{/if}}
    </table>
  </div>
</template>

<template name="topEarner">
  <div class="card" style="margin:20px">
    <h2>Know what products are earning you more by their sales</h2>
    <table class="table table-striped table-hover table-responsive table-bordered">
      {{#if topEarning}}
      <thead>
        <tr>
          <th>Product</th>
          <th>Total Earning</th>
        </tr>
      </thead>
      <tbody>
        {{#each topEarning}}
        <tr>
          <td class="productEarnerName">{{product}}</td>
          <td class="totalSalesEarner">{{totalSales}}</td>
        </tr>
        {{/each}}
      </tbody>
      {{ else }}
      <thead>
        <tr>
          <th>No Data to display</th>
        </tr>
      </thead>
      {{/if}}
    </table>
  </div>
</template>

<template name="statement">
  <div class="card" style="margin:20px">
    <h2>Individual products daily market performance guide</h2>
    <table class="table table-striped table-hover table-responsive table-bordered">
      {{#if statements}}
      <thead>
        <tr>
          <th>Date</th>
          <th>Product</th>
          <th>Quantity Sold</th>
          <th>Sales</th>
        </tr>
      </thead>
      <tbody>
        {{#each statements}}
        <tr>
          <td>{{dateString}}</td>
          <td>{{title}}</td>
          <td>{{quantity}}</td>
          <td>{{totalSales}}</td>
        </tr>
        {{/each}}
      </tbody>
      {{ else }}
      <thead>
        <tr>
          <th>No Data to display</th>
        </tr>
      </thead>
      {{/if}}
    </table>
  </div>
</template>

<template name="ordersAnalytics">
  <div class="card" style="margin:20px">
    <h2>Know order origins and what payment providers are being used.</h2>
    <table class="table table-striped table-hover table-responsive table-bordered">
      {{#if orders}}
      <thead>
        <tr>
          <th>Date</th>
          <th>Destination Country</th>
          <th>Destination City</th>
          <th>Tax</th>
          <th>Shipping</th>
          <th>Payment Processor</th>
        </tr>
      </thead>
      <tbody>
        {{#each orders}}
        <tr>
          <td>{{date}}</td>
          <td>{{country}}</td>
          <td>{{city}}</td>
          <td>{{taxes}}</td>
          <td>{{shipping}}</td>
          <td>{{paymentProcessor}}</td>
        </tr>
        {{/each}}
      </tbody>
      {{ else }}
      <thead>
        <tr>
          <th>No Data to display</th>
        </tr>
      </thead>
      {{/if}}
    </table>
  </div>
</template>
